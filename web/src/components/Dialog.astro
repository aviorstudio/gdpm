---
import type { HTMLAttributes } from 'astro/types';

interface Props extends HTMLAttributes<'dialog'> {
	id: string;
	title: string;
	description?: string;
	size?: 'md' | 'lg' | 'xl';
	titleId?: string;
}

const {
	id,
	title,
	description = '',
	open = false,
	size = 'md',
	titleId: titleIdProp,
	class: className,
	...dialogProps
} = Astro.props as Props;

const titleId = titleIdProp ?? `${id}-title`;

const maxWidthClass = {
	md: 'max-w-md',
	lg: 'max-w-lg',
	xl: 'max-w-xl',
}[size];

const hasDescriptionSlot = Astro.slots.has('description');
const shouldRenderDescription = hasDescriptionSlot || Boolean(description);

const dialogDisplayClass = open ? 'block' : 'hidden';

const dialogClass = [
	'fixed inset-0 z-50 m-auto max-h-[calc(100dvh-2rem)] w-[calc(100%-2rem)] overflow-y-auto rounded-2xl border border-slate-200 bg-white p-6 text-left shadow-xl outline-none backdrop:bg-slate-900/40 backdrop:backdrop-blur-sm',
	maxWidthClass,
	dialogDisplayClass,
	className,
]
	.filter(Boolean)
	.join(' ');
---

<dialog
	{...dialogProps}
	id={id}
	open={open || undefined}
	aria-labelledby={titleId}
	class={dialogClass}
>
	<h2 id={titleId} class="text-lg font-semibold text-slate-900">
		{title}
	</h2>

	{
		shouldRenderDescription && (
			<p class="mt-1 text-sm text-slate-600">
				{hasDescriptionSlot ? <slot name="description" /> : description}
			</p>
		)
	}

	<div class="mt-5">
		<slot />
	</div>
</dialog>
