---
export const prerender = false;

import Layout from '../layouts/Layout.astro';
import SupabaseAuth from '../components/SupabaseAuth/index.astro';
import { getServerSession, readSessionFromCookies } from '../services/supabase';

const earlySession = readSessionFromCookies(Astro.cookies);
if (earlySession) {
	return Astro.redirect('/');
}

const { session } = await getServerSession(Astro.cookies);
if (session) {
	return Astro.redirect('/');
}
---

<Layout>
	<section class="page">
		<div class="frame">
			<h1 class="title">Godot Plugin Manager</h1>
			<p class="headline">Access your plugin library</p>
	<p class="lede">
		Secure sign in powered by Supabase so you can store, version, and sync your Godot add-ons
		without leaving the manager.
	</p>

	<SupabaseAuth />
</div>
</section>

</Layout>
